{% extends 'base.html' %}
{% block title %}Edit Section{% endblock %}

{% block content %}
<main class="flex justify-center mt-4">
  <section class="w-full max-w-3xl">
    <div class="bg-white shadow-md rounded-2xl p-12">
      <h1 class="text-3xl font-bold text-orange-500">Edit Section</h1>

      <form action="" method="POST" class="flex flex-col gap-4 mt-10" >
        {% csrf_token %}
        {{form.non_field_errors}}
        <div class="relative">
          <label for="{{form.course.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Course</label>
          {{form.course}}
          {{form.course.errors}}
        </div>

        <div class="relative">
          <label for="{{form.section_number.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Section Number</label>
          {{form.section_number}}
          {{form.section_number.errors}}
        </div>
        
        <div class="flex gap-4">
          <div class="relative flex-1">
            <label for="{{form.professor.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Professor</label>
            {{form.professor}}
            {{form.professor.errors}}
          </div>

          <div class="relative flex-1">
            <label for="{{form.class_type.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Class Type</label>
            {{form.class_type}}
            {{form.class_type.errors}}
          </div>
        </div>

        <div class="flex gap-4">
          <div class="relative flex-1">
            <label for="{{form.day.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Day</label>
            {{form.day}}
            {{form.day.err.errors}}
          </div>

          <div class="relative flex-1">
            <label for="{{form.start_time.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Start Time</label>
            {{form.start_time}}
            {{form.start_time.errors}}
          </div>

          <div class="relative flex-1">
            <label for="{{form.end_time.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">End Time</label>
            {{form.end_time}}
            {{form.end_time.errors}}
          </div>
        </div>

        <div class="flex gap-4">
          <div class="relative flex-1">
            <label for="{{form.location.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Location</label>
            <!-- {{form.location}} -->
            {{form.location.errors}}
          </div>

          <div class="relative flex-1">
            <label for="{{form.capacity.id_for_label}}" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Capacity</label>
            <!-- {{form.capacity}} -->
            {{form.capacity.errors}}
          </div>
        </div>

        <div class="flex justify-end gap-2">
          <a href="{% url 'manage_section_view' %}"
                class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 mt-8">
            Cancel
          </a>
          <button type="submit" 
                  class="px-4 py-2 rounded-lg bg-orange-500 text-white hover:bg-orange-600 mt-8">
            Confirm
          </button>
      </div>
      </form>
    </div>
  </section>
</main>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const courseSelect = document.getElementById("id_course");
    const professorSelect = document.getElementById("id_professor");

    courseSelect.addEventListener("change", function() {
        const courseId = this.value;
        if (!courseId) return;

        fetch(`{% url 'get_professors' %}?course_id=${courseId}`)
            .then(response => response.json())
            .then(data => {
                professorSelect.innerHTML = '<option value="">---------</option>'; // reset
                data.forEach(prof => {
                    const option = document.createElement("option");
                    option.value = prof.id;
                    option.textContent = prof.name;
                    professorSelect.appendChild(option);
                });
            });
        });
  });
</script>

{% endblock %}
